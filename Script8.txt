--Опередить кто больше поставил лайков (всего) -мужчины или женщины?
select case (p.gender_id)
when '1' then 'male'
when '2' then 'female'
end as gender, COUNT(*) as likes_count
from profiles as p
join likes as l 
on p.user_id=l.user_id 
group by gender;

--Подсчитать общее количество лайков,которые получили 10 самых молодых пользоваталей
---10 самых молодых пользователей
select CONCAT(first_name,'',last_name) as user, timestampdiff(year, birthday, NOW()) as age 
from users as u
join profiles as p
on u.id =p.user_id 
order by age limit 10;

--Найти 10 пользователей, которые проявляют наименьшую активность
select u.id as id, COUNT(m.user_id)+ COUNT(l.user_id)+ COUNT(m2.from_user_id) as acts
from users u 
left join media m 
on u.id =m.user_id 
left JOIN likes l
 on u.id =l.user_id 
 left JOIN messages m2 
 on u.id =m2.from_user_id 
 GROUP BY id 
 order by acts 
limit 10;
 